<!-- Skip to main content link for accessibility -->
<a
  href="#main-content"
  class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-accent text-white px-4 py-2 rounded-md z-[60] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent"
>
  {{ 'nav.skip_to_content' | tr }}
</a>

<nav
  class="fixed top-0 w-full z-50 bg-background backdrop-blur-sm border-b border-border"
  role="navigation"
  [attr.aria-label]="'nav.main_navigation' | tr"
>
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <a routerLink="/" class="flex items-center space-x-2" (click)="closeMobileMenu()">
        <svg
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="text-accent"
        >
          <path d="M16 2L27 7V18C27 25 16 30 16 30C16 30 5 25 5 18V7L16 2Z" fill="currentColor" opacity="0.1" />
          <path
            d="M16 3L26 7.5V18C26 23.5 16 28 16 28C16 28 6 23.5 6 18V7.5L16 3Z"
            stroke="currentColor"
            stroke-width="1.5"
            fill="none"
          />
          <g transform="translate(16, 16)">
            <line x1="0" y1="-8" x2="0" y2="8" stroke="currentColor" stroke-width="2" />
            <line x1="-3" y1="-5" x2="3" y2="-5" stroke="currentColor" stroke-width="1.5" />
            <line x1="-4" y1="0" x2="4" y2="0" stroke="currentColor" stroke-width="1.5" />
            <line x1="-3" y1="5" x2="3" y2="5" stroke="currentColor" stroke-width="1.5" />
          </g>
        </svg>
        <span class="text-xl font-bold text-foreground">Heimdal Portal</span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <nav class="flex space-x-6" role="navigation" [attr.aria-label]="'nav.main_navigation' | tr">
          @for(item of navItems; track item.label){
          <a
            [routerLink]="item.href"
            class="text-sm text-muted hover:text-accent font-medium text-foreground hover:text-accent transition-colors"
            routerLinkActive="text-accent"
          >
            {{ item.label | tr }} </a
          >}
        </nav>

        <!-- Desktop Controls -->
        <div class="flex items-center space-x-2">
          <larp-button [variant]="'toggle'" (click)="toggleTheme()" [label]="isDark() ? 'â˜€ï¸' : 'ðŸŒ™'" />
          <larp-button [variant]="'toggle'" (click)="toggleLocale()" [label]="isDanish() ? 'DA' : 'EN'" />
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center space-x-2">
        <larp-button [variant]="'toggle'" (click)="toggleTheme()" label="{{ isDark() ? 'â˜€ï¸' : 'ðŸŒ™' }}" />
        <larp-button [variant]="'toggle'" (click)="toggleLocale()" [label]="isDanish() ? 'DA' : 'EN'" />

        <!-- Hamburger Menu -->
        <button
          (click)="toggleMobileMenu()"
          [attr.aria-label]="isMobileMenuOpen() ? ('nav.close_menu' | tr) : ('nav.open_menu' | tr)"
          [attr.aria-expanded]="isMobileMenuOpen()"
          aria-controls="mobile-menu"
          class="rounded-lg px-2 py-1 bg-neutral-800 hover:bg-neutral-700 text-white transition-colors duration-200"
        >
          <div class="w-5 h-5 flex flex-col justify-center items-center space-y-1">
            <span
              class="block w-4 h-0.5 bg-current transition-transform duration-200"
              [class.rotate-45]="isMobileMenuOpen()"
              [class.translate-y-1.5]="isMobileMenuOpen()"
            ></span>
            <span
              class="block w-4 h-0.5 bg-current transition-opacity duration-200"
              [class.opacity-0]="isMobileMenuOpen()"
            ></span>
            <span
              class="block w-4 h-0.5 bg-current transition-transform duration-200"
              [class.-rotate-45]="isMobileMenuOpen()"
              [class.-translate-y-1.5]="isMobileMenuOpen()"
            ></span>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="md:hidden transition-all duration-300 ease-in-out overflow-hidden"
    [class.max-h-96]="isMobileMenuOpen()"
    [class.opacity-100]="isMobileMenuOpen()"
    [class.max-h-0]="!isMobileMenuOpen()"
    [class.opacity-0]="!isMobileMenuOpen()"
    [attr.aria-hidden]="!isMobileMenuOpen()"
  >
    <div class="bg-card border-t border-border">
      <div class="container mx-auto px-4 py-4">
        <nav class="space-y-2" role="navigation" [attr.aria-label]="'nav.mobile_navigation' | tr">
          @for(item of navItems; track item.label){
          <a
            [routerLink]="item.href"
            (click)="closeMobileMenu()"
            class="block px-4 py-3 text-sm font-medium text-foreground hover:text-accent hover:bg-neutral-800 rounded-md transition-colors"
            routerLinkActive="text-accent"
          >
            {{ item.label | tr }} </a
          >}
        </nav>
      </div>
    </div>
  </div>
</nav>
